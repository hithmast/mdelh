<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MDE Lazy Hunter - Security Tool Illustration</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <pre class="banner">
███╗   ███╗██████╗ ███████╗██      ██╗  ██╗
████╗ ████║██╔══██╗██╔════╝██║     ██║  ██║
██╔████╔██║██║  ██║█████╗  ██║     ███████║
██║╚██╔╝██║██║  ██║██╔══╝  ██║     ██╔══██║
██║ ╚═╝ ██║██████╔╝███████╗███████╗██║  ██║
╚═╝     ╚═╝╚═════╚══════╝╚════╝╚═╝ ╚═╝  ╚═╝
        </pre>
        <h1>Microsoft Defender Lazy Hunter</h1>
        <p>Version: 1.0.1</p>
        <p>Author: Aly Emara</p>
    </header>
    <main>
        <section class="overview">
            <h2>What is MDE Lazy Hunter?</h2>
            <p>
                MDE Lazy Hunter is a Python script (requires Python 3.7+) for querying the Microsoft Defender for Endpoint API with built-in rate limiting and error handling.
            </p>
        </section>
        <section class="features">
            <h2>Key Features</h2>
            <ul>
                <li>Query Types Support:
                    <ul>
                        <li>File Hashes (SHA256, SHA1, MD5)</li>
                        <li>IP Addresses (Public and Private IPv4)</li>
                        <li>URLs and Hostnames</li>
                        <li>Device Software Inventory</li>
                        <li>Account UPN from Device Names</li>
                        <li>Email-based Device Events</li>
                    </ul>
                </li>
                <li>Rate Limiting:
                    <ul>
                        <li>Maximum 45 calls per minute</li>
                        <li>Maximum 1500 calls per hour</li>
                        <li>Automatic handling of 429 (Too Many Requests) responses</li>
                    </ul>
                </li>
                <li>Graceful Error Handling:
                    <ul>
                        <li>Two-stage interrupt handling (Ctrl+C)</li>
                        <li>Automatic retries for failed queries</li>
                        <li>Detailed error logging</li>
                    </ul>
                </li>
            </ul>
        </section>
        <section class="usage">
            <h2>Command Line Arguments</h2>
            <ul>
                <li><code>--iocs</code>: Process IOCs from a file</li>
                <li><code>--di</code>: Query device inventory</li>
                <li><code>--emails</code>: Query device events by email</li>
                <li><code>--diupn</code>: Query Account UPN from device names</li>
                <li><code>--config</code>: Update API key in config.json</li>
            </ul>
        </section>
        <section class="output">
            <h2>Output Files</h2>
            <p>Results are saved in the "results" directory as CSV files:</p>
            <ul>
                <li>results.csv - IOC query results</li>
                <li>device_inventory_results.csv - Device inventory data</li>
                <li>email_results.csv - Email-based query results</li>
                <li>account_upn_results.csv - Device UPN mapping results</li>
            </ul>
        </section>
    </main>
    <footer>
        <p>Requires: aiohttp, dateutil, pytz, aiofiles, argparse</p>
        <p>&copy; 2024 Aly Emara</p>
    </footer>
</body>
</html>
